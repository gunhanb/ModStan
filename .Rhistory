subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Pooling",
tau_prior =  0.5)
mod_stan
load_all()
roxygen2::roxygenize()
library(ModStan)
mod_stan
library(devtools)
load_all()
document()
library(ModStan)
?mod_stan
mod_stan()
mod_stan
document()
library(ModStan)
?mod_stan
document()
?mod_stan
library(roxygen2)
roxygenize()
?mod_stan
roxygenize()
roxygenize()
roxygenize()
document()
document()
load_all()
document()
?mod_Stan
?mod_stan
library(ModStan)
?mod_stan
document()
?mod_stan
data('dat.Dupilumab', package = "ModStan")
## Fitting an Emax model using shrinkage estimation for ED50 parameters
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Pooling",
tau_prior =  0.5)
document()
library(ModStan)
mod_stan
## Fitting an Emax model using shrinkage estimation for ED50 parameters
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Pooling",
tau_prior =  0.5)
## Fitting an Emax model using shrinkage estimation for ED50 parameters
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Shrinkage",
tau_prior =  0.5)
document()
## Fitting an Emax model using shrinkage estimation for ED50 parameters
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Shrinkage",
tau_prior =  0.5)
## Fitting an Emax model using shrinkage estimation for ED50 parameters
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Stratified",
tau_prior =  0.5)
shrinkage.Dupilumab.stan$fit_sum
results = shrinkage.Dupilumab.stan$fit_sum
round(results['theta_1', '50%'], 2)
document()
pkgbuild::compile_dll()
roxygen2::roxygenize()
library(devtools)
?install
document()
build()
document()
R.version
document()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
document()
library(testthat)
test()
document()
library(ModStan)
set.seed(23344)
data('dat.dupilumab', package = "ModStan")
## Fitting an Emax model using shrinkage estimation for ED50 parameters
data('dat.Dupilumab', package = "ModStan")
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 8,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  0.5)
dat.Dupilumab
head(dat.Dupilumab)
document()
data('dat.Dupilumab', package = "ModStan")
head(dat.Dupilumab)
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 2,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  0.5)
library(devtools)
document()
load_all()
library(ModStan)
?mod_stan
data('dat.Dupilumab', package = "ModStan")
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 2,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  0.5)
results = shrinkage.Dupilumab.stan$fit_sum
results
results['theta_1', '50%']
shrinkage.Dupilumab.stan$fit
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
reference_freq = 24 * 7 * 2,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  1)
print(shrinkage.Dupilumab.stan$fit, pars = c("theta_0", "theta_1", "theta_2_new", "beta_theta_2")
)
print(shrinkage.Dupilumab.stan$fit, pars = c("theta_0", "theta_1", "theta_2", "beta_theta_2"))
print(shrinkage.Dupilumab.stan$fit, pars = c("theta_0", "theta_1", "theta_2", "beta_theta_2", "sigma"))
shrinkage.Dupilumab.stan$fit_sum
24 * 7
24 * 7 * 2
24 * 7 * 4
data('dat.Dupilumab', package = "ModStan")
library(rstan)
?sampling
library(devtools)
document()
data('dat.Dupilumab', package = "ModStan")
init = list(list("theta_0" = -20, "theta_1" = -60),
list("theta_0" = -25, "theta_1" = -70),
list("theta_0" = -35, "theta_1" = -80))
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  1,
init = init)
results = shrinkage.Dupilumab.stan$fit_sum
round(results['theta_1', '50%'], 2)
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  1)
results = shrinkage.Dupilumab.stan$fit_sum
round(results['theta_1', '50%'], 2)
mod_stan
document()
data('dat.Dupilumab', package = "ModStan")
pooling.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
reference_freq = 24 * 7 * 2,
model = "Pooling",
beta_prior =  1,
beta_prior_dist = "half-normal")
document()
pooling.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
reference_freq = 24 * 7 * 2,
model = "Pooling",
beta_prior =  1,
beta_prior_dist = "half-normal")
results = pooling.Dupilumab.stan$fit_sum
round(results['theta_0', '50%'], 2)
R.version
?mod_stan
build_vignettes()
## ----dataset------------------------------------------------------------------
library("ModStan")
data("dat.Dupilumab", package = "ModStan")
head(dat.Dupilumab)
## ----bnhmFit, results="hide"--------------------------------------------------
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior =  1,
beta_prior_dist = "half-normal")
stratified.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Stratified",
beta_prior =  1,
beta_prior_dist = "half-normal")
?build_vignettes
build_vignettes()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#"
)
print(shrinkage.Dupilumab.stan)
results = shrinkage.Dupilumab.stan
cat("Dose-response modeling using ModStan\n")
cat("E_0\n")
print(round(results[c('theta_0'), -c(2, 3, 5, 7, 9, 10)], digits))
results = results$fit_sum
cat("Dose-response modeling using ModStan\n")
cat("E_0\n")
print(round(results[c('theta_0'), -c(2, 3, 5, 7, 9, 10)], digits))
digits = 2
cat("Dose-response modeling using ModStan\n")
cat("E_0\n")
print(round(results[c('theta_0'), -c(2, 3, 5, 7, 9, 10)], digits))
cat("E_max\n")
print(round(results[c('theta_1'), -c(2, 3, 5, 7, 9, 10)], digits))
cat("ED_50 (reference frequency)\n")
print(round(results[c('theta_2'), -c(2, 3, 5, 7, 9, 10)], digits))
results[c('theta_2')
]
results
results = shrinkage.Dupilumab.stan
print(results, pars = c("theta_0", "theta_1"))
(results, pars = c("theta_0", "theta_1"))
shrinkage.Dupilumab.stan$fit_sum
shrinkage.Dupilumab.stan$fit
print(shrinkage.Dupilumab.stan$fit, pars = "theta_0")
print(shrinkage.Dupilumab.stan$fit, pars = "theta_2")
stratified.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Stratified",
beta_prior =  1,
beta_prior_dist = "half-normal")
library(ModStan)
stratified.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Stratified",
beta_prior =  1,
beta_prior_dist = "half-normal")
results = stratified.Dupilumab.stan$fit_sum
round(results['theta_2_2', '50%'], 2)
results
results['theta_1', '50%']
results['theta_2', '50%']
results['theta_0', '50%']
results[, '50%']
x = results[, '50%']
x = data.frame(x)
View(x)
library(devtools)
document()
?check
document()
remove.packages("ModStan")
install_github("gunhanb/ModStan")
library(ModStan)
?ModStan
?mod_stan
data("dat.dupilumab")
data("dat.Dupilumab")
partial.shrinkage.Dupilumab.stan = mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.dupilumab,
model = "Shrinkage",
reference_freq = 24 * 7 * 8,
beta_prior_dist = "half-normal",
beta_prior = 0.5,
chains = 4,
iter = 2000,
warmup = 1000)
partial.shrinkage.Dupilumab.stan = mod_stan(dose = dose,
resp = resp,
subgroup = subgroup,
frequency = frequency,
data = dat.Dupilumab,
model = "Shrinkage",
beta_prior_dist = "half-normal",
beta_prior = 0.5,
chains = 4,
iter = 2000,
warmup = 1000)
library("shinystan")
launch_shinystan(partial.shrinkage.Dupilumab.stan$stanfit)
partial.shrinkage.Dupilumab.stan$fit_sum
print(partial.shrinkage.Dupilumab.stan)
install.packages("broom.mixed")
library(rstan)
?samplin
?sampling
library(bayesmeta)
?bayesmeta
getwd(9)
getwd()
dose     = c(0, 300, 200, 300, 100, 300)
schedule = c(1, 1, 2, 2, 3, 3)
resp     = c(-18.1, -73.7, -65.4, -68.2, -44.8, -63.5)
sigma    = c(5.2, 5.2, 5.2, 5.1, 5.0, 4.9)
## For complete pooling
dose_rescaled = c(0, 600, 200, 300, 50, 150)
dat.Dupilumab = data.frame(dose = dose,
resp = resp,
sigma = sigma,
schedule = schedule,
dose_rescaled = dose_rescaled)
dat.Dupilumab
save(dat.dupilumab, file = "data/dat.Dupilumab.RData")
dat.Dupilumab = data.frame(dose = dose,
schedule = schedule,
resp = resp,
sigma = sigma,
dose_rescaled = dose_rescaled)
save(dat.dupilumab, file = "data/dat.Dupilumab.RData")
save(dat.Dupilumab, file = "data/dat.Dupilumab.RData")
library(devtools)
document()
?mod_stan
?mod_stan
set.seed(23344)
## Load the dataset
data('dat.Dupilumab', package = "ModStan")
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
frequency = frequency,
reference_freq = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
dat.Dupilumab
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
frequency = freq,
reference_freq = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
document()
mod_stan()
mod_stan
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
frequency = freq,
reference_freq = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
document()
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
frequency = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
mod_stan
document()
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
frequency = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
document()
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
frequency = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
document()
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
freq = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
document()
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
freq = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
tau_prior =  1,
tau_prior_dist = "half-normal")
### compare with results
results = shrinkage.Dupilumab.stan$fit_sum
round(results['theta_1', '50%'], 2)
results
shrinkage.Dupilumab.stan$fit_sum
results['Emax', '50%'], 2)
round(results['Emax', '50%'], 2)
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
freq = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
seed = 2234
tau_prior =  1,
tau_prior_dist = "half-normal")
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
freq = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
seed = 2234,
tau_prior =  1,
tau_prior_dist = "half-normal")
shrinkage.Dupilumab.stan  <- mod_stan(dose = dose,
resp = resp,
schedule = schedule,
sigma = sigma,
freq = freq,
freq_ref = 24 * 7 * 2,
data = dat.Dupilumab,
model = "PP-RE",
stan_seed = 2234,
tau_prior =  1,
tau_prior_dist = "half-normal")
shrinkage.Dupilumab.stan$fit_sum
### compare with results
results = shrinkage.Dupilumab.stan$fit_sum
round(results['Emax', '50%'], 2)
